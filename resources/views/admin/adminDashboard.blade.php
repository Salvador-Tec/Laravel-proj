@extends('admin.noname')

@section('content')

 <div class="container-xxl flex-grow-1 container-p-y">
              <div class="row g-6">
                <!-- Website Analytics -->
                <div class="col-xl-6 col">
                  <div
                    class="swiper-container swiper-container-horizontal swiper swiper-card-advance-bg"
                    id="swiper-with-pagination-cards">
                    <div class="swiper-wrapper">
                      <div class="swiper-slide">
                        <div class="row">
                          <div class="col-12">
                            <h5 class="text-white mb-0">Website Analytics</h5>
                            <small>Total 28.5% Conversion Rate</small>
                          </div>
                          <div class="row">
                            <div class="col-lg-7 col-md-9 col-12 order-2 order-md-1 pt-md-9">
                              <h6 class="text-white mt-0 mt-md-3 mb-4">Traffic</h6>
                              <div class="row">
                                <div class="col-6">
                                  <ul class="list-unstyled mb-0">
                                    <li class="d-flex mb-4 align-items-center">
                                      <p class="mb-0 fw-medium me-2 website-analytics-text-bg">28%</p>
                                      <p class="mb-0">Sessions</p>
                                    </li>
                                    <li class="d-flex align-items-center">
                                      <p class="mb-0 fw-medium me-2 website-analytics-text-bg">1.2k</p>
                                      <p class="mb-0">Leads</p>
                                    </li>
                                  </ul>
                                </div>
                                <div class="col-6">
                                  <ul class="list-unstyled mb-0">
                                    <li class="d-flex mb-4 align-items-center">
                                      <p class="mb-0 fw-medium me-2 website-analytics-text-bg">3.1k</p>
                                      <p class="mb-0">Page Views</p>
                                    </li>
                                    <li class="d-flex align-items-center">
                                      <p class="mb-0 fw-medium me-2 website-analytics-text-bg">12%</p>
                                      <p class="mb-0">Conversions</p>
                                    </li>
                                  </ul>
                                </div>
                              </div>
                            </div>
                            <div class="col-lg-5 col-md-3 col-12 order-1 order-md-2 my-4 my-md-0 text-center">
                              <img
                                src="../../img/illustrations/card-website-analytics-1.png"
                                alt="Website Analytics"
                                height="150"
                                class="card-website-analytics-img" />
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="swiper-slide">
                        <div class="row">
                          <div class="col-12">
                            <h5 class="text-white mb-0">Website Analytics</h5>
                            <small>Total 28.5% Conversion Rate</small>
                          </div>
                          <div class="col-lg-7 col-md-9 col-12 order-2 order-md-1 pt-md-9">
                            <h6 class="text-white mt-0 mt-md-3 mb-4">Spending</h6>
                            <div class="row">
                              <div class="col-6">
                                <ul class="list-unstyled mb-0">
                                  <li class="d-flex mb-4 align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">12h</p>
                                    <p class="mb-0">Spend</p>
                                  </li>
                                  <li class="d-flex align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">127</p>
                                    <p class="mb-0">Order</p>
                                  </li>
                                </ul>
                              </div>
                              <div class="col-6">
                                <ul class="list-unstyled mb-0">
                                  <li class="d-flex mb-4 align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">18</p>
                                    <p class="mb-0">Order Size</p>
                                  </li>
                                  <li class="d-flex align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">2.3k</p>
                                    <p class="mb-0">Items</p>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-5 col-md-3 col-12 order-1 order-md-2 my-4 my-md-0 text-center">
                            <img
                              src="../../img/illustrations/card-website-analytics-2.png"
                              alt="Website Analytics"
                              height="150"
                              class="card-website-analytics-img" />
                          </div>
                        </div>
                      </div>
                      <div class="swiper-slide">
                        <div class="row">
                          <div class="col-12">
                            <h5 class="text-white mb-0">Website Analytics</h5>
                            <small>Total 28.5% Conversion Rate</small>
                          </div>
                          <div class="col-lg-7 col-md-9 col-12 order-2 order-md-1 pt-md-9">
                            <h6 class="text-white mt-0 mt-md-3 mb-4">Revenue Sources</h6>
                            <div class="row">
                              <div class="col-6">
                                <ul class="list-unstyled mb-0">
                                  <li class="d-flex mb-4 align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">268</p>
                                    <p class="mb-0">Direct</p>
                                  </li>
                                  <li class="d-flex align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">62</p>
                                    <p class="mb-0">Referral</p>
                                  </li>
                                </ul>
                              </div>
                              <div class="col-6">
                                <ul class="list-unstyled mb-0">
                                  <li class="d-flex mb-4 align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">890</p>
                                    <p class="mb-0">Organic</p>
                                  </li>
                                  <li class="d-flex align-items-center">
                                    <p class="mb-0 fw-medium me-2 website-analytics-text-bg">1.2k</p>
                                    <p class="mb-0">Campaign</p>
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                          <div class="col-lg-5 col-md-3 col-12 order-1 order-md-2 my-4 my-md-0 text-center">
                            <img
                              src="../../img/illustrations/card-website-analytics-3.png"
                              alt="Website Analytics"
                              height="150"
                              class="card-website-analytics-img" />
                          </div>
                        </div>
                      </div>
                    </div>
                    <div class="swiper-pagination"></div>
                  </div>
                </div>
                <!--/ Website Analytics -->

                <!-- Average Daily Sales -->
                <div class="col-xl-3 col-sm-6">
                  <div class="card h-100">
                    <div class="card-header pb-0">
                      <h5 class="mb-3 card-title">Average Daily Sales</h5>
                      <p class="mb-0 text-body">Total Sales This Month</p>
                      <h4 class="mb-0">$28,450</h4>
                    </div>
                    <div class="card-body px-0">
                      <div id="averageDailySales"></div>
                    </div>
                  </div>
                </div>
                <!--/ Average Daily Sales -->

                <!-- Sales Overview -->
                <div class="col-xl-3 col-sm-6">
                  <div class="card h-100">
                    <div class="card-header">
                      <div class="d-flex justify-content-between">
                        <p class="mb-0 text-body">Sales Overview</p>
                        <p class="card-text fw-medium text-success">+18.2%</p>
                      </div>
                      <h4 class="card-title mb-1">$42.5k</h4>
                    </div>
                    <div class="card-body">
                      <div class="row">
                        <div class="col-4">
                          <div class="d-flex gap-2 align-items-center mb-2">
                            <span class="badge bg-label-info p-1 rounded"
                              ><i class="icon-base ti tabler-shopping-cart icon-sm"></i
                            ></span>
                            <p class="mb-0">Order</p>
                          </div>
                          <h5 class="mb-0 pt-1">62.2%</h5>
                          <small class="text-body-secondary">6,440</small>
                        </div>
                        <div class="col-4">
                          <div class="divider divider-vertical">
                            <div class="divider-text">
                              <span class="badge-divider-bg bg-label-secondary">VS</span>
                            </div>
                          </div>
                        </div>
                        <div class="col-4 text-end">
                          <div class="d-flex gap-2 justify-content-end align-items-center mb-2">
                            <p class="mb-0">Visits</p>
                            <span class="badge bg-label-primary p-1 rounded"
                              ><i class="icon-base ti tabler-link icon-sm"></i
                            ></span>
                          </div>
                          <h5 class="mb-0 pt-1">25.5%</h5>
                          <small class="text-body-secondary">12,749</small>
                        </div>
                      </div>
                      <div class="d-flex align-items-center mt-6">
                        <div class="progress w-100" style="height: 10px">
                          <div
                            class="progress-bar bg-info"
                            style="width: 70%"
                            role="progressbar"
                            aria-valuenow="70"
                            aria-valuemin="0"
                            aria-valuemax="100"></div>
                          <div
                            class="progress-bar bg-primary"
                            role="progressbar"
                            style="width: 30%"
                            aria-valuenow="30"
                            aria-valuemin="0"
                            aria-valuemax="100"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--/ Sales Overview -->

                <!-- Earning Reports -->
                <div class="col-md-6">
                  <div class="card h-100">
                    <div class="card-header pb-0 d-flex justify-content-between">
                      <div class="card-title mb-0">
                        <h5 class="mb-1">Earning Reports</h5>
                        <p class="card-subtitle">Weekly Earnings Overview</p>
                      </div>
                      <div class="dropdown">
                        <button
                          class="btn btn-text-secondary rounded-pill text-body-secondary border-0 p-2 me-n1"
                          type="button"
                          id="earningReportsId"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-md text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="earningReportsId">
                          <a class="dropdown-item" href="javascript:void(0);">View More</a>
                          <a class="dropdown-item" href="javascript:void(0);">Delete</a>
                        </div>
                      </div>
                    </div>
                    <div class="card-body">
                      <div class="row align-items-center g-md-8">
                        <div class="col-12 col-md-5 d-flex flex-column">
                          <div class="d-flex gap-2 align-items-center mb-3 flex-wrap">
                            <h2 class="mb-0">$468</h2>
                            <div class="badge rounded bg-label-success">+4.2%</div>
                          </div>
                          <small class="text-body">You informed of this week compared to last week</small>
                        </div>
                        <div class="col-12 col-md-7 ps-xl-8">
                          <div id="weeklyEarningReports"></div>
                        </div>
                      </div>
                      <div class="border rounded p-5 mt-5">
                        <div class="row gap-4 gap-sm-0">
                          <div class="col-12 col-sm-4">
                            <div class="d-flex gap-2 align-items-center">
                              <div class="badge rounded bg-label-primary p-1">
                                <i class="icon-base ti tabler-currency-dollar icon-18px"></i>
                              </div>
                              <h6 class="mb-0 fw-normal">Earnings</h6>
                            </div>
                            <h4 class="my-2">$545.69</h4>
                            <div class="progress w-75" style="height: 4px">
                              <div
                                class="progress-bar"
                                role="progressbar"
                                style="width: 65%"
                                aria-valuenow="65"
                                aria-valuemin="0"
                                aria-valuemax="100"></div>
                            </div>
                          </div>
                          <div class="col-12 col-sm-4">
                            <div class="d-flex gap-2 align-items-center">
                              <div class="badge rounded bg-label-info p-1">
                                <i class="icon-base ti tabler-chart-pie-2 icon-18px"></i>
                              </div>
                              <h6 class="mb-0 fw-normal">Profit</h6>
                            </div>
                            <h4 class="my-2">$256.34</h4>
                            <div class="progress w-75" style="height: 4px">
                              <div
                                class="progress-bar bg-info"
                                role="progressbar"
                                style="width: 50%"
                                aria-valuenow="50"
                                aria-valuemin="0"
                                aria-valuemax="100"></div>
                            </div>
                          </div>
                          <div class="col-12 col-sm-4">
                            <div class="d-flex gap-2 align-items-center">
                              <div class="badge rounded bg-label-danger p-1">
                                <i class="icon-base ti tabler-brand-paypal icon-18px"></i>
                              </div>
                              <h6 class="mb-0 fw-normal">Expense</h6>
                            </div>
                            <h4 class="my-2">$74.19</h4>
                            <div class="progress w-75" style="height: 4px">
                              <div
                                class="progress-bar bg-danger"
                                role="progressbar"
                                style="width: 65%"
                                aria-valuenow="65"
                                aria-valuemin="0"
                                aria-valuemax="100"></div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--/ Earning Reports -->

                <!-- Support Tracker -->
                <div class="col-12 col-md-6">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between">
                      <div class="card-title mb-0">
                        <h5 class="mb-1">Support Tracker</h5>
                        <p class="card-subtitle">Last 7 Days</p>
                      </div>
                      <div class="dropdown">
                        <button
                          class="btn btn-text-secondary rounded-pill text-body-secondary border-0 p-2 me-n1"
                          type="button"
                          id="supportTrackerMenu"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-md text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="supportTrackerMenu">
                          <a class="dropdown-item" href="javascript:void(0);">View More</a>
                          <a class="dropdown-item" href="javascript:void(0);">Delete</a>
                        </div>
                      </div>
                    </div>
                    <div class="card-body row">
                      <div class="col-12 col-sm-4">
                        <div class="mt-lg-4 mt-lg-2 mb-lg-6 mb-2">
                          <h2 class="mb-0">164</h2>
                          <p class="mb-0">Total Tickets</p>
                        </div>
                        <ul class="p-0 m-0">
                          <li class="d-flex gap-4 align-items-center mb-lg-3 pb-1">
                            <div class="badge rounded bg-label-primary p-1_5">
                              <i class="icon-base ti tabler-ticket icon-md"></i>
                            </div>
                            <div>
                              <h6 class="mb-0 text-nowrap">New Tickets</h6>
                              <small class="text-body-secondary">142</small>
                            </div>
                          </li>
                          <li class="d-flex gap-4 align-items-center mb-lg-3 pb-1">
                            <div class="badge rounded bg-label-info p-1_5">
                              <i class="icon-base ti tabler-circle-check icon-md"></i>
                            </div>
                            <div>
                              <h6 class="mb-0 text-nowrap">Open Tickets</h6>
                              <small class="text-body-secondary">28</small>
                            </div>
                          </li>
                          <li class="d-flex gap-4 align-items-center pb-1">
                            <div class="badge rounded bg-label-warning p-1_5">
                              <i class="icon-base ti tabler-clock icon-md"></i>
                            </div>
                            <div>
                              <h6 class="mb-0 text-nowrap">Response Time</h6>
                              <small class="text-body-secondary">1 Day</small>
                            </div>
                          </li>
                        </ul>
                      </div>
                      <div class="col-12 col-md-8">
                        <div id="supportTracker"></div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--/ Support Tracker -->

                <!-- Sales By Country -->
                <div class="col-xxl-4 col-md-6 order-1 order-xl-0">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between">
                      <div class="card-title mb-0">
                        <h5 class="mb-1">Sales by Countries</h5>
                        <p class="card-subtitle">Monthly Sales Overview</p>
                      </div>
                      <div class="dropdown">
                        <button
                          class="btn btn-text-secondary btn-icon rounded-pill text-body-secondary border-0 me-n1"
                          type="button"
                          id="salesByCountry"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-22px text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="salesByCountry">
                          <a class="dropdown-item" href="javascript:void(0);">Download</a>
                          <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                          <a class="dropdown-item" href="javascript:void(0);">Share</a>
                        </div>
                      </div>
                    </div>
                    <div class="card-body">
                      <ul class="p-0 m-0">
                        <li class="d-flex align-items-center mb-4">
                          <div class="avatar flex-shrink-0 me-4">
                            <i class="fis fi fi-us rounded-circle fs-2"></i>
                          </div>
                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">$8,567k</h6>
                              </div>
                              <small class="text-body">United states</small>
                            </div>
                            <div class="user-progress">
                              <p class="text-success fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-up"></i>
                                25.8%
                              </p>
                            </div>
                          </div>
                        </li>
                        <li class="d-flex align-items-center mb-4">
                          <div class="avatar flex-shrink-0 me-4">
                            <i class="fis fi fi-br rounded-circle fs-2"></i>
                          </div>
                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">$2,415k</h6>
                              </div>
                              <small class="text-body">Brazil</small>
                            </div>
                            <div class="user-progress">
                              <p class="text-danger fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-down"></i>
                                6.2%
                              </p>
                            </div>
                          </div>
                        </li>
                        <li class="d-flex align-items-center mb-4">
                          <div class="avatar flex-shrink-0 me-4">
                            <i class="fis fi fi-in rounded-circle fs-2"></i>
                          </div>
                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">$865k</h6>
                              </div>
                              <small class="text-body">India</small>
                            </div>
                            <div class="user-progress">
                              <p class="text-success fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-up"></i>
                                12.4%
                              </p>
                            </div>
                          </div>
                        </li>
                        <li class="d-flex align-items-center mb-4">
                          <div class="avatar flex-shrink-0 me-4">
                            <i class="fis fi fi-au rounded-circle fs-2"></i>
                          </div>
                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">$745k</h6>
                              </div>
                              <small class="text-body">Australia</small>
                            </div>
                            <div class="user-progress">
                              <p class="text-danger fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-down"></i>
                                11.9%
                              </p>
                            </div>
                          </div>
                        </li>
                        <li class="d-flex align-items-center mb-4">
                          <div class="avatar flex-shrink-0 me-4">
                            <i class="fis fi fi-fr rounded-circle fs-2"></i>
                          </div>
                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">$45</h6>
                              </div>
                              <small class="text-body">France</small>
                            </div>
                            <div class="user-progress">
                              <p class="text-success fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-up"></i>
                                16.2%
                              </p>
                            </div>
                          </div>
                        </li>
                        <li class="d-flex align-items-center">
                          <div class="avatar flex-shrink-0 me-4">
                            <i class="fis fi fi-cn rounded-circle fs-2"></i>
                          </div>
                          <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                              <div class="d-flex align-items-center">
                                <h6 class="mb-0 me-1">$12k</h6>
                              </div>
                              <small class="text-body">China</small>
                            </div>
                            <div class="user-progress">
                              <p class="text-success fw-medium mb-0 d-flex align-items-center gap-1">
                                <i class="icon-base ti tabler-chevron-up"></i>
                                14.8%
                              </p>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <!--/ Sales By Country -->

                <!-- Total Earning -->
                <div class="col-12 col-md-6 col-xxl-4 order-2 order-xl-0">
                  <div class="card h-100">
                    <div class="card-header">
                      <div class="d-flex justify-content-between align-items-center">
                        <h5 class="mb-0 card-title">Total Earning</h5>
                        <div class="dropdown">
                          <button
                            class="btn btn-text-secondary rounded-pill text-body-secondary border-0 p-2 me-n1"
                            type="button"
                            id="totalEarning"
                            data-bs-toggle="dropdown"
                            aria-haspopup="true"
                            aria-expanded="false">
                            <i class="icon-base ti tabler-dots-vertical icon-md text-body-secondary"></i>
                          </button>
                          <div class="dropdown-menu dropdown-menu-end" aria-labelledby="totalEarning">
                            <a class="dropdown-item" href="javascript:void(0);">View More</a>
                            <a class="dropdown-item" href="javascript:void(0);">Delete</a>
                          </div>
                        </div>
                      </div>
                      <div class="d-flex align-items-center">
                        <h2 class="mb-0 me-2">87%</h2>
                        <i class="icon-base ti tabler-chevron-up text-success me-1"></i>
                        <h6 class="text-success mb-0">25.8%</h6>
                      </div>
                    </div>
                    <div class="card-body">
                      <div id="totalEarningChart"></div>
                      <div class="d-flex align-items-start my-4">
                        <div class="badge rounded bg-label-primary p-2 me-4 rounded">
                          <i class="icon-base ti tabler-brand-paypal icon-md"></i>
                        </div>
                        <div class="d-flex justify-content-between w-100 gap-2 align-items-center">
                          <div class="me-2">
                            <h6 class="mb-0">Total Revenue</h6>
                            <small class="text-body">Client Payment</small>
                          </div>
                          <h6 class="mb-0 text-success">+$126</h6>
                        </div>
                      </div>
                      <div class="d-flex align-items-start">
                        <div class="badge rounded bg-label-secondary p-2 me-4 rounded">
                          <i class="icon-base ti tabler-currency-dollar icon-md"></i>
                        </div>
                        <div class="d-flex justify-content-between w-100 gap-2 align-items-center">
                          <div class="me-2">
                            <h6 class="mb-0">Total Sales</h6>
                            <small class="text-body">Refund</small>
                          </div>
                          <h6 class="mb-0 text-success">+$98</h6>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <!--/ Total Earning -->

                <!-- Monthly Campaign State -->
                <div class="col-xxl-4 col-md-6">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between">
                      <div class="card-title mb-0">
                        <h5 class="mb-1">Monthly Campaign State</h5>
                        <p class="card-subtitle">8.52k Social Visiters</p>
                      </div>
                      <div class="dropdown">
                        <button
                          class="btn btn-text-secondary rounded-pill text-body-secondary border-0 p-2 me-n1"
                          type="button"
                          id="MonthlyCampaign"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-md text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="MonthlyCampaign">
                          <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                          <a class="dropdown-item" href="javascript:void(0);">Download</a>
                          <a class="dropdown-item" href="javascript:void(0);">View All</a>
                        </div>
                      </div>
                    </div>
                    <div class="card-body">
                      <ul class="p-0 m-0">
                        <li class="mb-6 d-flex justify-content-between align-items-center">
                          <div class="badge bg-label-success rounded p-1_5">
                            <i class="icon-base ti tabler-mail icon-md"></i>
                          </div>
                          <div class="d-flex justify-content-between w-100 flex-wrap">
                            <h6 class="mb-0 ms-4">Emails</h6>
                            <div class="d-flex">
                              <p class="mb-0">12,346</p>
                              <p class="ms-4 text-success mb-0">0.3%</p>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6 d-flex justify-content-between align-items-center">
                          <div class="badge bg-label-info rounded p-1_5">
                            <i class="icon-base ti tabler-link icon-md"></i>
                          </div>
                          <div class="d-flex justify-content-between w-100 flex-wrap">
                            <h6 class="mb-0 ms-4">Opened</h6>
                            <div class="d-flex">
                              <p class="mb-0">8,734</p>
                              <p class="ms-4 text-success mb-0">2.1%</p>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6 d-flex justify-content-between align-items-center">
                          <div class="badge bg-label-warning rounded p-1_5">
                            <i class="icon-base ti tabler-mouse icon-md"></i>
                          </div>
                          <div class="d-flex justify-content-between w-100 flex-wrap">
                            <h6 class="mb-0 ms-4">Clicked</h6>
                            <div class="d-flex">
                              <p class="mb-0">967</p>
                              <p class="ms-4 text-danger mb-0">1.4%</p>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6 d-flex justify-content-between align-items-center">
                          <div class="badge bg-label-primary rounded p-1_5">
                            <i class="icon-base ti tabler-users icon-md"></i>
                          </div>
                          <div class="d-flex justify-content-between w-100 flex-wrap">
                            <h6 class="mb-0 ms-4">Subscribe</h6>
                            <div class="d-flex">
                              <p class="mb-0">345</p>
                              <p class="ms-4 text-success mb-0">8.5%</p>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6 d-flex justify-content-between align-items-center">
                          <div class="badge bg-label-secondary rounded p-1_5">
                            <i class="icon-base ti tabler-alert-triangle icon-md"></i>
                          </div>
                          <div class="d-flex justify-content-between w-100 flex-wrap">
                            <h6 class="mb-0 ms-4">Complaints</h6>
                            <div class="d-flex">
                              <p class="mb-0">10</p>
                              <p class="ms-4 text-danger mb-0">1.5%</p>
                            </div>
                          </div>
                        </li>
                        <li class="mb-3 d-flex justify-content-between align-items-center">
                          <div class="badge bg-label-danger rounded p-1_5">
                            <i class="icon-base ti tabler-ban icon-md"></i>
                          </div>
                          <div class="d-flex justify-content-between w-100 flex-wrap">
                            <h6 class="mb-0 ms-4">Unsubscribe</h6>
                            <div class="d-flex">
                              <p class="mb-0">86</p>
                              <p class="ms-4 text-success mb-0">0.8%</p>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <!--/ Monthly Campaign State -->

                <!-- Source Visit -->
                <div class="col-xxl-4 col-md-6 col-12">
                  <div class="card h-100">
                    <div class="card-header d-flex justify-content-between">
                      <div class="card-title mb-0">
                        <h5 class="mb-1">Source Visits</h5>
                        <p class="card-subtitle">38.4k Visitors</p>
                      </div>
                      <div class="dropdown">
                        <button
                          class="btn btn-text-secondary rounded-pill text-body-secondary border-0 p-2 me-n1"
                          type="button"
                          id="sourceVisits"
                          data-bs-toggle="dropdown"
                          aria-haspopup="true"
                          aria-expanded="false">
                          <i class="icon-base ti tabler-dots-vertical icon-md text-body-secondary"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end" aria-labelledby="sourceVisits">
                          <a class="dropdown-item" href="javascript:void(0);">Refresh</a>
                          <a class="dropdown-item" href="javascript:void(0);">Download</a>
                          <a class="dropdown-item" href="javascript:void(0);">View All</a>
                        </div>
                      </div>
                    </div>
                    <div class="card-body">
                      <ul class="list-unstyled mb-0">
                        <li class="mb-6">
                          <div class="d-flex align-items-center">
                            <div class="badge bg-label-secondary text-body p-2 me-4 rounded">
                              <i class="icon-base ti tabler-shadow icon-md"></i>
                            </div>
                            <div class="d-flex justify-content-between w-100 flex-wrap gap-2">
                              <div class="me-2">
                                <h6 class="mb-0">Direct Source</h6>
                                <small class="text-body">Direct link click</small>
                              </div>
                              <div class="d-flex align-items-center">
                                <p class="mb-0">1.2k</p>
                                <div class="ms-4 badge bg-label-success">+4.2%</div>
                              </div>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6">
                          <div class="d-flex align-items-center">
                            <div class="badge bg-label-secondary text-body p-2 me-4 rounded">
                              <i class="icon-base ti tabler-globe icon-md"></i>
                            </div>
                            <div class="d-flex justify-content-between w-100 flex-wrap gap-2">
                              <div class="me-2">
                                <h6 class="mb-0">Social Network</h6>
                                <small class="text-body">Social Channels</small>
                              </div>
                              <div class="d-flex align-items-center">
                                <p class="mb-0">31.5k</p>
                                <div class="ms-4 badge bg-label-success">+8.2%</div>
                              </div>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6">
                          <div class="d-flex align-items-center">
                            <div class="badge bg-label-secondary text-body p-2 me-4 rounded">
                              <i class="icon-base ti tabler-mail icon-md"></i>
                            </div>
                            <div class="d-flex justify-content-between w-100 flex-wrap gap-2">
                              <div class="me-2">
                                <h6 class="mb-0">Email Newsletter</h6>
                                <small class="text-body">Mail Campaigns</small>
                              </div>
                              <div class="d-flex align-items-center">
                                <p class="mb-0">893</p>
                                <div class="ms-4 badge bg-label-success">+2.4%</div>
                              </div>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6">
                          <div class="d-flex align-items-center">
                            <div class="badge bg-label-secondary text-body p-2 me-4 rounded">
                              <i class="icon-base ti tabler-external-link icon-md"></i>
                            </div>
                            <div class="d-flex justify-content-between w-100 flex-wrap gap-2">
                              <div class="me-2">
                                <h6 class="mb-0">Referrals</h6>
                                <small class="text-body">Impact Radius Visits</small>
                              </div>
                              <div class="d-flex align-items-center">
                                <p class="mb-0">342</p>
                                <div class="ms-4 badge bg-label-danger">-0.4%</div>
                              </div>
                            </div>
                          </div>
                        </li>
                        <li class="mb-6">
                          <div class="d-flex align-items-center">
                            <div class="badge bg-label-secondary text-body p-2 me-4 rounded">
                              <i class="icon-base ti tabler-ad icon-md"></i>
                            </div>
                            <div class="d-flex justify-content-between w-100 flex-wrap gap-2">
                              <div class="me-2">
                                <h6 class="mb-0">ADVT</h6>
                                <small class="text-body">Google ADVT</small>
                              </div>
                              <div class="d-flex align-items-center">
                                <p class="mb-0">2.15k</p>
                                <div class="ms-4 badge bg-label-success">+9.1%</div>
                              </div>
                            </div>
                          </div>
                        </li>
                        <li>
                          <div class="d-flex align-items-center">
                            <div class="badge bg-label-secondary text-body p-2 me-4 rounded">
                              <i class="icon-base ti tabler-star icon-md"></i>
                            </div>
                            <div class="d-flex justify-content-between w-100 flex-wrap gap-2">
                              <div class="me-2">
                                <h6 class="mb-0">Other</h6>
                                <small class="text-body">Many Sources</small>
                              </div>
                              <div class="d-flex align-items-center">
                                <p class="mb-0">12.5k</p>
                                <div class="ms-4 badge bg-label-success">+6.2%</div>
                              </div>
                            </div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <!--/ Source Visit -->

                <!-- Projects table -->
                
                <div class="col-xxl-8">
                  <!-- Départ -->
<div class="relative mb-4">
  <!-- Conteneur calendrier + recherche -->
  <div id="departure-calendar-container" class="hidden absolute bottom-full mb-2 z-10 bg-white p-4 rounded shadow">
    <div class="flex items-center">
      <input
        type="date"
        id="departure-date"
        class="border border-gray-300 rounded p-2"
        onchange="showDepartureSearchButton()" />

      <!-- 🔍 Bouton de recherche -->
      <button
        id="departure-search-button"
        onclick="filterDeparturesByDate()"
        class="hidden ml-2 p-2 bg-pr-400 rounded-full text-white hover:bg-pr-500 flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512" fill="currentColor">
          <path
            d="M505 442.7L405.3 343c28.4-35.3 45.7-80.3 45.7-129
              0-114.9-93.1-208-208-208S35 99.1 35 214s93.1
              208 208 208c48.7 0 93.7-17.3
              129-45.7l99.7 99.7c9.4 9.4
              24.6 9.4 33.9 0l28.3-28.3c9.4-9.4
              9.4-24.6 0-33.9zM81 214c0-73.4
              59.6-133 133-133s133 59.6
              133 133-59.6 133-133 133-133-59.6-133-133z" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Bouton Départs -->
  <a href="javascript:void(0);" onclick="toggleDepartureCalendar()">
    <div class="flex items-center p-4 bg-white rounded-lg shadow-xs hover:bg-pr-200">
      <div class="p-3 mr-4 bg-pr-400 rounded-full">
        <!-- icône voiture -->
        <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 640 512" style="fill: #fff;">
          <path d="... (ton path svg ici) ..." />
        </svg>
      </div>
      <div>
        <p class="text-lg font-medium text-pr-400">Départs</p>
      </div>
    </div>
  </a>
</div>

<!-- Arrivée -->
<!-- Arrivée -->
<style>
  /* Wrapper relatif autour de l'input */
  .input-wrapper {
    position: relative;
    display: inline-block;
  }

  /* Input date avec padding à droite pour laisser la place au bouton */
  #arrival-date {
    padding-right: 2.5rem; /* espace pour le bouton */
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 6px 10px;
    font-size: 1rem;
    width: 180px;
    box-sizing: border-box;
  }

  /* Bouton recherche positionné à l'intérieur de l'input, à droite */
  #arrival-search-button {
    position: absolute;
    right: 6px;
    top: 50%;
    transform: translateY(-50%);
    background-color: #3b82f6; /* bg-pr-400 */
    border: none;
    border-radius: 50%;
    padding: 6px;
    cursor: pointer;
    display: none; /* caché par défaut */
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    z-index: 10;
  }

  #arrival-search-button:hover {
    background-color: #2563eb; /* bg-pr-500 */
  }

  #arrival-search-button svg {
    width: 16px;
    height: 16px;
  }
</style>

<div class="relative mb-4">
  <div id="arrival-calendar-container" class="mb-2 z-10 bg-white p-4 rounded shadow w-fit">
    <div class="input-wrapper">
      <input
        type="date"
        id="arrival-date"
        onchange="showArrivalSearchButton()" />
      <button
        id="arrival-search-button"
        onclick="filterArrivalsByDate()"
        aria-label="Rechercher par date arrivée"
        title="Rechercher">
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 512 512">
          <path d="M505 442.7L405.3 343c28.4-35.3 45.7-80.3 45.7-129
            0-114.9-93.1-208-208-208S35 99.1 35 214s93.1
            208 208 208c48.7 0 93.7-17.3
            129-45.7l99.7 99.7c9.4 9.4
            24.6 9.4 33.9 0l28.3-28.3c9.4-9.4
            9.4-24.6 0-33.9zM81 214c0-73.4
            59.6-133 133-133s133 59.6
            133 133-59.6 133-133 133-133-59.6-133-133z"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Bouton Arrivées -->
  <a href="javascript:void(0);" onclick="toggleArrivalCalendar()">
    <div class="flex items-center p-4 bg-white rounded-lg shadow-xs hover:bg-pr-200">
      <div class="p-3 mr-4 bg-pr-400 rounded-full">
        <svg xmlns="http://www.w3.org/2000/svg" height="1.5em" viewBox="0 0 576 512" style="fill:#fff;">
          <!-- ... icône ... -->
        </svg>
      </div>
      <div>
        <p class="text-lg font-medium text-pr-400">Arrivé</p>
      </div>
    </div>
  </a>
</div>

<script>
  function toggleDepartureCalendar() {
    const calendar = document.getElementById('departure-calendar-container');
    calendar.classList.toggle('hidden');
  }

  function showDepartureSearchButton() {
    const button = document.getElementById('departure-search-button');
    button.classList.remove('hidden');
  }

  function filterDeparturesByDate() {
  const selectedDate = document.getElementById('departure-date').value;
  const rows = document.querySelectorAll('.reservation-row');

  if (!selectedDate) {
    // Afficher toutes les lignes si aucune date sélectionnée
    rows.forEach(row => row.style.display = '');
    return;
  }

  rows.forEach(row => {
    const rowDate = row.getAttribute('data-start-date');

    // Affiche uniquement les lignes qui matchent exactement
    if (rowDate && rowDate.trim() === selectedDate.trim()) {
      row.style.display = '';
    } else {
      row.style.display = 'none';
    }
  });
}

  function toggleArrivalCalendar() {
    const calendar = document.getElementById('arrival-calendar-container');
    calendar.classList.toggle('hidden');
  }

  function showArrivalSearchButton() {
  const button = document.getElementById('arrival-search-button');

  // Supprime toutes les classes qui peuvent cacher le bouton
  button.classList.remove('hidden');
  button.style.display = 'inline-flex';
}


  function filterArrivalsByDate() {
    const selectedDate = document.getElementById('arrival-date').value;
    const rows = document.querySelectorAll('.reservation-row');

    rows.forEach(row => {
      const rowDate = row.getAttribute('data-end-date');
      row.style.display = rowDate === selectedDate ? '' : 'none';
    });
  }
</script>




                  <div class="card">
                    <div class="table-responsive mb-4">
                      <div class="col-xxl-12">
    <div class="card">
        <div class="table-responsive mb-4">
            <table class="table datatable-project table-sm">
                <thead class="border-top">
                    <tr>
                        <th>Client</th>
                        <th>Voiture</th>
                        <th>Type de boite</th>
                        <th>Matricule</th>
                        <th>Début à</th>
                        <th>Fin à</th>
                        <th>Durée</th>
                        <th>Prix à choisir</th>
                        <th>Prix</th>
                        <th>Méthode de paiement</th>
                        <th>Statut du paiement</th>
                        <th>Statut</th>
                        <th>Actions</th>
                        <th>Contrat</th>
                    </tr>
                </thead>
                <tbody>
                    @forelse ($reservations as $reservation)
                        <tr class="reservation-row" 
  data-start-date="{{ \Carbon\Carbon::parse($reservation->start_date)->format('Y-m-d') }}" 
  data-end-date="{{ \Carbon\Carbon::parse($reservation->end_date)->format('Y-m-d') }}"
>
                            <td>
                                <a href="{{ route('users', ['highlight' => $reservation->identity_number]) }}" class="text-primary">
                                    @if ($reservation->first_name && $reservation->last_name)
                                        {{ $reservation->first_name }} {{ $reservation->last_name }}
                                    @else
                                        Aucun client
                                    @endif
                                </a>
                                <div class="text-muted small">
                                    {{ $reservation->mobile_number ?? 'Aucun numéro' }}<br>
                                    cin: {{ $reservation->identity_number ?? 'Aucune' }}<br>
                                    Conducteur: 
                                    @if ($reservation->last_name_conducteur && $reservation->first_name_conducteur)
                                        {{ $reservation->last_name_conducteur }} {{ $reservation->first_name_conducteur }}
                                    @else
                                        Aucun
                                    @endif
                                </div>
                            </td>
                            <td>
                                <a href="{{ route('cars.index', ['highlight' => $reservation->car->id]) }}" class="text-primary">
                                    {{ $reservation->car->brand }} {{ $reservation->car->model }}
                                </a>
                            </td>
                            <td>{{ $reservation->car->gearbox_type ?? 'N/A' }}</td>
                            <td>{{ $reservation->car->matricule ?? 'N/A' }}</td>
                            <td>
                                {{ \Carbon\Carbon::parse($reservation->start_date)->format('y-m-d') }}
                                {{ \Carbon\Carbon::createFromFormat('H:i:s', $reservation->delivery_time)->format('H:i') ?? 'Heure invalide' }}
                            </td>
                            <td>
                                {{ \Carbon\Carbon::parse($reservation->end_date)->format('y-m-d') }}
                                {{ \Carbon\Carbon::createFromFormat('H:i:s', $reservation->return_time)->format('H:i') ?? 'Heure invalide' }}
                            </td>
                            <td>{{ \Carbon\Carbon::parse($reservation->end_date)->diffInDays(\Carbon\Carbon::parse($reservation->start_date)) }} jours</td>
                            <td>
                                <!-- Prix manuel + select -->
                               <div class="relative">
                                                        <input type="number"
                                                        step="0.01"
                                                        min="0"
                                                        class="manual-price-input w-full px-1 py-2 mb-1 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition duration-150 ease-in-out shadow-sm"
                                                        placeholder="💰 Saisir un tarif personnalisé"
                                                        oninput="showSaveButton(this)"
                                                        data-reservation-id="{{ $reservation->id }}"
                                                        data-days="{{ $reservation->days }}"
                                                        value="{{ $reservation->manual_price }}" />
                                                 
                                                        <!-- Bouton d’enregistrement -->
                                                        <button class="save-price-btn absolute right-2 top-2 hidden text-green-600 hover:text-green-800"
                                                                onclick="handleManualPriceInput(this.previousElementSibling)">
                                                            💾
                                                        </button>
                                                    </div>



                                <select class="price-selector w-full px-1 py-2 rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition duration-150 ease-in-out bg-white shadow-sm"
                                                          data-reservation-id="{{ $reservation->id }}"
                                                          data-days="{{ $reservation->days }}"
                                                          onchange="handlePriceSelection(this)"
                                                          @if(in_array($reservation->payment_status, ['non payé', 'Partiellement payé'])) required @endif>
                                                    <option value="" disabled {{ is_null($reservation->price_type) ? 'selected' : '' }} class="text-gray-400">
                                                      💰 Sélectionner un tarif
                                                    </option>
                                              
                                                    <option value="seasonal" data-price="{{ $reservation->car->seasonal_price }}" {{ $reservation->price_type == 'seasonal' ? 'selected' : '' }}>
                                                      🍂 Tarif saisonnier — {{ number_format($reservation->car->seasonal_price, 2) }} DT
                                                    </option>
                                              
                                                    <option value="estimated" data-price="{{ $reservation->car->price_per_day }}" {{ $reservation->price_type == 'estimated' ? 'selected' : '' }}>
                                                      📅 Tarif standard — {{ number_format($reservation->car->price_per_day, 2) }} DT
                                                    </option>
                                              
                                                    <option value="summer" data-price="{{ $reservation->car->summer_price }}" {{ $reservation->price_type == 'summer' ? 'selected' : '' }}>
                                                      ☀️ Tarif d'été — {{ number_format($reservation->car->summer_price, 2) }} DT
                                                    </option>
                                                  </select>
                                                </div>
                                              </td>
                                              
                                              <td class="px-4 py-3 text-sm" id="final-price-{{ $reservation->id }}">
                                                {{ number_format($reservation->total_price, 2) }} DT
                                                 @if(strtolower(trim($reservation->status)) === 'clôturé')
        <span class="text-green-600">Garantie: 0.00 DT</span>
    @else
        <span class="text-green-600">Garantie: {{ number_format($reservation->garantie, 2) }} DT</span>
    @endif
                                              </td>
                                              

                            </td>
                            <td>
                                {{ number_format($reservation->total_price, 2) }} DT<br>
                                Garantie : 
                                @if(strtolower(trim($reservation->status)) === 'clôturé')
                                    0.00 DT
                                @else
                                    {{ number_format($reservation->garantie, 2) }} DT
                                @endif
                            </td>
                            <td>
                                @if ($reservation->payment_method == 'Carte crédit')
                                    <span class="badge bg-primary">{{ $reservation->payment_method }}</span>
                                @elseif ($reservation->payment_method == 'Cheque')
                                    <span class="badge bg-success">{{ $reservation->payment_method }}</span>
                                @elseif ($reservation->payment_method == 'Espèce')
                                    <span class="badge bg-warning">{{ $reservation->payment_method }}</span>
                                @else
                                    <span class="badge bg-secondary">Aucune méthode</span>
                                @endif
                            </td>
                            <td>
                                @if ($reservation->payment_status == 'payed')
                                    <span class="badge bg-success">Payé</span>
                                @elseif ($reservation->payment_status === 'Partiellement payé')
                                    <span class="badge bg-info">Partiel: {{ $reservation->amount_paid }}</span>
                                @elseif ($reservation->payment_status == 'non payé')
                                    <span class="badge bg-danger">Non payé</span>
                                @endif
                            </td>
                              @php
    $status = strtolower(trim($reservation->status));
    $statusConfig = [
        'pré-réservé' => ['color' => '#64748b', 'icon' => 'fas fa-clock'],
        'reserve' => ['color' => '#f97316', 'icon' => 'fas fa-hourglass-half'],
        'active' => ['color' => '#22c55e', 'icon' => 'fas fa-check-circle'],
        'clôturé' => ['color' => '#ef4444', 'icon' => 'fas fa-ban'],
        'prolongé'    => ['color' => '#3b82f6', 'icon' => 'fas fa-calendar-plus'],
    ];
    $backgroundColor = $statusConfig[$status]['color'] ?? '#6b7280';
    $icon = $statusConfig[$status]['icon'] ?? 'fas fa-question';
@endphp     

                            <td>
                                <span class="badge" style="background-color: {{ $statusConfig[strtolower(trim($reservation->status))]['color'] ?? '#6b7280' }};">
                                    <i class="{{ $statusConfig[strtolower(trim($reservation->status))]['icon'] ?? 'fas fa-question' }}"></i>
                                    {{ ucfirst(strtolower(trim($reservation->status))) }}
                                </span>
                                 <select class="status-select mt-2 text-sm" data-id="{{ $reservation->id }}">
        @foreach(array_keys($statusConfig) as $statusOption)
            <option value="{{ $statusOption }}" @if($statusOption === $status) selected @endif>
                {{ ucfirst($statusOption) }}
            </option>
        @endforeach
        <option value="annulé" class="text-red-600">Annulé</option>
    </select>
    <input type="hidden" class="previous-status" value="{{ strtolower(trim($reservation->status)) }}">
 <!-- POPUP MODALE pour prolongation -->
<div id="prolong-form-{{ $reservation->id }}"
     class="prolong-form hidden fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center">
    <div class="bg-white rounded-lg shadow-lg p-6 w-full max-w-md relative">

        <!-- Formulaire -->
        <label>Date de début :
            <input type="date" class="start-date-input border rounded px-1"
                   value="{{ \Carbon\Carbon::parse($reservation->start_date)->format('Y-m-d') }}">
        </label>
        <label>Heure de début :
            <input type="time" class="start-time-input border rounded px-1"
                   value="{{ \Carbon\Carbon::parse($reservation->delivery_time)->format('H:i') }}">
        </label>
        <label>Date de fin :
            <input type="date" class="end-date-input border rounded px-1"
                   value="{{ \Carbon\Carbon::parse($reservation->end_date)->format('Y-m-d') }}">
        </label>
        <label>Heure de fin :
            <input type="time" class="end-time-input border rounded px-1"
                   value="{{ \Carbon\Carbon::parse($reservation->return_time)->format('H:i') }}">
        </label>

        <!-- Boutons -->
        <div class="mt-4 flex justify-end space-x-2">
            <button 
            type="button" 
            class="cancel-prolong bg-red-600 text-white px-3 py-1 rounded mr-2 font-semibold"
            onclick="document.getElementById('prolong-form-{{ $reservation->id }}').classList.add('hidden')"
        >
            Annulé
        </button>
            <button type="button"
                    class="validate-prolong px-3 py-1 rounded text-white font-semibold"
                    data-id="{{ $reservation->id }}"
                    style="background-color: #22c55e;">
                Valider
            </button>
        </div>

        <!-- X Fermer -->
        <button onclick="closeProlongModal({{ $reservation->id }})"
                class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-xl font-bold">&times;</button>
    </div>
</div>

                            </td>
                           <td class="px-0 py-6 w-36 text-sm flex flex-row justify-center gap-3 items-center">
    <!-- Icône Eye (Voir détails) -->
    <a href="{{ route('admin.formulaire', ['id' => $reservation->id]) }}"
       class="p-2 bg-blue-500 rounded-full text-white hover:bg-blue-600 transition-colors duration-200"
       title="Voir détails">
        <!-- Eye SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="w-5 h-5" viewBox="0 0 576 512">
            <path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM144 256a144 144 0 1 1 288 0 144 144 0 1 1 -288 0z"/>
        </svg>
    </a>

    <!-- Icône Payment (Payer) -->
    <a href="{{ route('editPayment', ['reservation' => $reservation->id]) }}"
       class="p-2 bg-green-500 rounded-full text-white hover:bg-green-600 transition-colors duration-200"
       title="Payer">
        <!-- Payment SVG -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="w-5 h-5" viewBox="0 0 640 512">
            <path d="M0 96C0 78.3 14.3 64 32 64H608c17.7 0 32 14.3 32 32V128H0V96zM0 192H640V416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32V192zm128 96c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32s-14.3-32-32-32z"/>
        </svg>
    </a>
</td>

                            <td>
                                @if ($reservation->status == 'active')
                                    <a href="{{ route('reservation.showContrat', $reservation->id) }}" class="text-danger">
                                        <i class="fas fa-file-contract fa-2x"></i>
                                    </a> 
                                @endif
                            </td>
                        </tr>
                    @empty
                        <tr><td colspan="14" class="text-center">Aucune réservation</td></tr>
                    @endforelse
                </tbody>
            </table>
        </div>
    </div>
</div>

                    </div>
                  </div>
                </div>
                <!--/ Projects table -->
              </div>
            </div>
             <script>
                            function toggleCalendar() {
                                const calendar = document.getElementById('calendar-container');
                                calendar.classList.toggle('hidden');
                            }
                        
                            function showSearchButton() {
                                const button = document.getElementById('search-button');
                                button.classList.remove('hidden');
                            }
                        
                            function filterDeparturesByDate() {
        const selectedDate = document.getElementById('departure-date').value;
        const rows = document.querySelectorAll('.reservation-row');

        rows.forEach(row => {
            const rowDate = row.getAttribute('data-start-date');
            if (rowDate === selectedDate) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    }
   

  

  
                        </script>
                                       <script>
                                  function syncReturnTime() {
            var deliveryTime = document.getElementById('search-time').value;
            document.getElementById('return-time').value = deliveryTime;
        }
                                </script>
   <script>
        document.querySelectorAll('.validate-prolong').forEach(btn => {
    btn.addEventListener('click', function () {
        const reservationId = this.dataset.id;
        const form = document.getElementById(`prolong-form-${reservationId}`);
        const startDate = form.querySelector('.start-date-input').value;
        const startTime = form.querySelector('.start-time-input').value;
        const endDate = form.querySelector('.end-date-input').value;
        const endTime = form.querySelector('.end-time-input').value;
        const previousStatus = document.querySelector(`select[data-id="${reservationId}"]`)
            .closest('td').querySelector('.previous-status').value;

        fetch(`/reservation/prolong/${reservationId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
            },
            body: JSON.stringify({ 
                start_date: startDate, 
                start_time: startTime,
                end_date: endDate, 
                end_time: endTime,
                status: previousStatus 
            })
        })
        .then(res => res.json())
        .then(data => {
            if (data.success) {
                alert("Dates et heures mises à jour et statut restauré !");
                form.classList.add('hidden');
                // ... reste de ton code de mise à jour d'affichage
            } else {
                alert(data.message || "Échec de la mise à jour.");
            }
        })
        .catch(err => {
            console.error(err);
            alert("Erreur serveur.");
        });
    });
});

        </script>
    <script>
        document.querySelectorAll('.status-select').forEach(select => {
            select.addEventListener('change', function () {
                const reservationId = this.dataset.id;
                const newStatus = this.value.toLowerCase();
    
                if (newStatus === 'prolongé') {
    // Affiche le formulaire de prolongation
    openProlongModal(reservationId);
    return;
}
function openProlongModal(id) {
    const modal = document.getElementById(`prolong-form-${id}`);
    if (modal) {
        modal.classList.remove('hidden');
    }
}

function closeProlongModal(id) {
    const modal = document.getElementById(`prolong-form-${id}`);
    if (modal) {
        modal.classList.add('hidden');
    }
}
                if (newStatus === 'annulé') {
                    if (!confirm("Êtes-vous sûr de vouloir annuler (supprimer) cette réservation ?")) {
                        this.value = this.querySelector('option[selected]').value; // revert
                        return;
                    }
                    
    
                    fetch(`/reservation/${reservationId}`, {
                        method: 'DELETE',
                        headers: {
                            'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                        }
                    })
                    .then(res => res.json())
                    .then(data => {
                        if (data.success) {
                            alert("Réservation annulée avec succès.");
                            location.reload(); // ou tu peux enlever la ligne du DOM si tu préfères
                        } else {
                            alert(data.message || "Erreur lors de l’annulation.");
                        }
                    })
                    .catch(error => {
                        console.error(error);
                        alert("Erreur serveur.");
                    });
    
                    return;
                }
    
                // Sinon, mise à jour classique
                const statusMap = {
                    'pré-réservé': { color: '#64748b', icon: 'fas fa-clock' },
                    'reserve': { color: '#f97316', icon: 'fas fa-hourglass-half' },
                    'active': { color: '#22c55e', icon: 'fas fa-check-circle' },
                    'clôturé': { color: '#ef4444', icon: 'fas fa-ban' },
                    'prolongé':    { color: '#3b82f6', icon: 'fas fa-calendar-plus' }
                };
    
                fetch(`/reservation/toggle-status/${reservationId}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                    },
                    body: JSON.stringify({ status: newStatus })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        const config = statusMap[newStatus] || { color: '#6b7280', icon: 'fas fa-question' };
                        const display = document.getElementById(`status-display-${reservationId}`);
    
                        display.style.backgroundColor = config.color;
                        display.innerHTML = `<i class="${config.icon}"></i> <span class="status-text">${newStatus.charAt(0).toUpperCase() + newStatus.slice(1)}</span>`;
                    } else {
                        alert(data.message || "Changement de statut non autorisé.");
                    }
                })
                .catch(error => {
                    console.error(error);
                    alert("Erreur de communication avec le serveur.");
                });
            });
        });
    </script>
    
    
    
    <script>
        function scrollToReservations() {
            window.scrollTo({
                top: 300,
                behavior: 'smooth'
            });
        }

    </script>

<script>
 function filterCreditedReservations() {
    document.querySelectorAll('tbody tr').forEach(row => {
        row.style.display = 'none'; // Cacher toutes les lignes
    });

    document.querySelectorAll('tbody tr').forEach(row => {
        const paymentCell = row.querySelector('.statusp-toggle'); // le <td>
        const badge = paymentCell ? paymentCell.querySelector('[data-payment-status]') : null; // le <span>

        if (badge && badge.dataset.paymentStatus.trim().toLowerCase() === 'non payé') {
            row.style.display = ''; // Afficher si le statut est "non payé"
        }
    });

    // Scroll vers le tableau
    const table = document.querySelector('.w-full.overflow-hidden.rounded-lg.shadow-xs');
    if (table) {
        window.scrollTo({
            top: table.offsetTop - 20,
            behavior: 'smooth'
        });
    }
}


// Fonction pour réinitialiser le filtre
function resetFilter() {
    document.querySelectorAll('tbody tr').forEach(row => {
        row.style.display = '';
    });

}
</script>

<script>
    
    
    
    function resetFilter() {
        activeFilter = null;
        // Réinitialisation de l'affichage de toutes les lignes
        document.querySelectorAll('tbody tr').forEach(row => {
            row.style.display = '';
            row.classList.remove('highlight-row');
        });
        document.getElementById('filter-indicator').classList.add('hidden');
    }
    </script>
    <script>


    function updateFilterIndicator() {
        const indicator = document.getElementById('filter-indicator');
        if (!indicator) return;
    
        // Affichage du message si le filtre "crédit" est activé
        if (activeFilter === 'credit') {
            indicator.textContent = 'Filtre actif: Réservations créditées';
            indicator.classList.remove('hidden');
        } else {
            indicator.classList.add('hidden');
        }
    }
        </script>

    <script>

    function scrollToTable() {
        const table = document.querySelector('.w-full.overflow-hidden.rounded-lg.shadow-xs');
        if (table) {
            table.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }
    </script>
           <script>


    function updatePrice(reservationId, priceType) {
    // Récupérer les données en fonction du type de prix
    let price = 0;
    let priceElement = document.getElementById('final-price-' + reservationId);

    switch (priceType) {
        case 'seasonal':
            price = {{ $reservation->car->seasonal_price }} * {{ $reservation->days }};
            break;
        case 'estimated':
            price = {{ $reservation->car->price_per_day }} * {{ $reservation->days }};
            break;
        case 'summer':
            price = {{ $reservation->car->summer_price }} * {{ $reservation->days }};
            break;
        default:
            price = 0;
            break;
    }

    // Mettre à jour l'affichage du prix final
    priceElement.innerText = price.toFixed(2) + " DT";

    // Optionnel: envoyer la nouvelle valeur au backend via AJAX
    /*
    fetch('/update-price', {
        method: 'POST',
        body: JSON.stringify({ reservationId, price }),
        headers: {
            'Content-Type': 'application/json',
        }
    });
    */
}

    </script>
    
    <style>
    .highlight-row {
        background-color: rgba(254, 252, 191, 0.5); /* Jaune clair */
        transition: background-color 0.3s ease;
    }
    </style>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const toggles = document.querySelectorAll('.status-toggle');
    
            toggles.forEach(toggle => {
                toggle.addEventListener('click', function () {
                    const reservationId = this.dataset.id;
                    const currentStatus = this.dataset.status;
    
                    fetch(`/reservation/toggle-status/${reservationId}`, {
                        method: 'POST',
                        headers: {
                            'X-CSRF-TOKEN': '{{ csrf_token() }}',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ status: currentStatus })
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            // Mettre à jour le badge
                            this.dataset.status = data.newStatus;
                            this.textContent = data.newStatus;
                            this.style.backgroundColor = data.newStatus === 'active' ? '#22c55e' : '#ef4444';
    
                            // Afficher ou cacher le PDF
                            const pdfLink = document.getElementById(`pdf-link-${reservationId}`);
                            if (pdfLink) {
                                pdfLink.style.display = data.newStatus === 'active' ? 'inline-block' : 'none';
                            }
                        }
                    });
                });
            });
        });
    </script>
    

    <script>
function filterActiveReservations() {
    // Masquer toutes les lignes du tableau
    document.querySelectorAll('tbody tr').forEach(row => {
        row.style.display = 'none';
    });
    
    // Afficher seulement les réservations actives
    document.querySelectorAll('tbody tr').forEach(row => {
        const statusBadge = row.querySelector('.status-toggle');
        if (statusBadge && statusBadge.dataset.status === 'active') {
            row.style.display = '';
        }
    });
    
    // Faire défiler jusqu'au tableau
    const tablePosition = document.querySelector('.w-full.overflow-hidden.rounded-lg.shadow-xs').offsetTop;
    window.scrollTo({
        top: tablePosition - 20,
        behavior: 'smooth'
    });
}

// Fonction pour réinitialiser le filtre
function resetFilter() {
    document.querySelectorAll('tbody tr').forEach(row => {
        row.style.display = '';
    });
}

document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.price-selector').forEach(select => {
        select.addEventListener('change', function() {
            const reservationId = this.dataset.reservationId;
            const priceType = this.value;
            
            // Envoyer une requête AJAX pour mettre à jour le type de prix
            fetch(`/reservations/${reservationId}/update-price-type`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').getAttribute('content')
                },
                body: JSON.stringify({ price_type: priceType })
            })
            .then(response => response.json())
            .then(data => {
                if(data.success) {
                    // Actualiser la page ou mettre à jour l'interface utilisateur
                    location.reload();
                }
            });
        });
    });
});
</script>

<script>
    // Cette fonction est appelée lorsque la page est chargée
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll('.price-selector').forEach(selectElement => {
            // Récupérer l'option sélectionnée au chargement de la page
            const selectedOption = selectElement.querySelector('option:checked');
            
            // Vérifier si une option est déjà sélectionnée
            if (selectedOption) {
                // Appeler la fonction pour calculer le prix total
                handlePriceSelection(selectElement);
            }
        });
    });

    function handlePriceSelection(selectElement) {
    // Récupération de l'option sélectionnée
    const selectedOption = selectElement.options[selectElement.selectedIndex];

    // Si aucune option valide n'est sélectionnée
    if (!selectedOption.value) {
        console.log("Aucun type de prix sélectionné");
        return;
    }

    // Récupérer les données nécessaires
    const reservationId = selectElement.dataset.reservationId;
    const days = parseInt(selectElement.dataset.days);
    const priceType = selectedOption.value;
    const pricePerDay = parseFloat(selectedOption.dataset.price);
    
    if (isNaN(pricePerDay) || isNaN(days)) {
        console.error("Données invalides pour le calcul du prix :", { pricePerDay, days });
        return;
    }

    const totalPrice = (pricePerDay * days).toFixed(2); // Calcul du prix total
    console.log(`Prix calculé pour la réservation ${reservationId}: ${totalPrice} DT`);

    // Mise à jour de l'affichage du prix final
    const finalPriceElement = document.getElementById(`final-price-${reservationId}`);
    if (finalPriceElement) {
        finalPriceElement.textContent = totalPrice + ' DT'; // Affichage du prix calculé
    } else {
        console.error(`Élément pour afficher le prix introuvable pour la réservation ${reservationId}`);
    }

    // Si le champ est requis, on envoie la mise à jour au serveur
    if (selectElement.hasAttribute('required')) {
        updatePriceOnServer(reservationId, priceType, pricePerDay, days, totalPrice)
            .then(data => {
                if (!data.success) throw new Error(data.message || 'Erreur de mise à jour');
                console.log("Prix mis à jour:", data);
            })
            .catch(error => {
                console.error("Erreur lors de la mise à jour:", error);
                alert("Erreur lors de la mise à jour: " + error.message);
            });
    }
}


    // Fonction pour envoyer la mise à jour au serveur
    function updatePriceOnServer(reservationId, priceType, pricePerDay, days, totalPrice) {
        fetch(`/reservations/${reservationId}/update-price`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content
            },
            body: JSON.stringify({
                price_type: priceType,
                price_per_day: pricePerDay,
                days: days,
                total_price: totalPrice
            })
        })
        .then(response => {
            if (!response.ok) throw new Error('Erreur serveur');
            return response.json();
        })
        .then(data => {
            if (!data.success) throw new Error(data.message || 'Erreur de mise à jour');
            console.log("Prix mis à jour:", data);
        })
        .catch(error => {
            console.error("Erreur:", error);
            alert("Erreur lors de la mise à jour: " + error.message);
        });
    }
  function showSaveButton(inputElement) {
    const saveButton = inputElement.parentElement.querySelector('.save-price-btn');
    if (inputElement.value.trim() !== '') {
        saveButton.classList.remove('hidden');
    } else {
        saveButton.classList.add('hidden');
    }
}
function handleManualPriceInput(inputElement) {
    const pricePerDay = parseFloat(inputElement.value);  // Le prix par jour entré par l'utilisateur
    const reservationId = inputElement.dataset.reservationId;
    const days = parseInt(inputElement.dataset.days);

    const finalPriceElement = document.getElementById(`final-price-${reservationId}`);

    if (isNaN(pricePerDay) || pricePerDay <= 0 || isNaN(days) || days <= 0) {
        alert("Veuillez saisir un nombre valide (supérieur à 0)");
        inputElement.value = '';
        if (finalPriceElement) finalPriceElement.textContent = '-- DT';
        return;
    }

    const totalPrice = (pricePerDay * days).toFixed(2);  // Calcul du prix total
    if (finalPriceElement) {
        finalPriceElement.textContent = `${totalPrice} DT`;
        finalPriceElement.classList.add('text-green-500', 'font-bold');
        setTimeout(() => finalPriceElement.classList.remove('text-green-500', 'font-bold'), 2000);
    }

    // Envoi de la requête pour mettre à jour le prix
    fetch(`/reservations/${reservationId}/update-price`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRF-TOKEN': document.querySelector('meta[name="csrf-token"]').content,
            'X-Requested-With': 'XMLHttpRequest'
        },
        body: JSON.stringify({
            manual_price: pricePerDay,  // Valeur du prix manuel
            price_per_day: pricePerDay,  // S'assurer que price_per_day est envoyé
            days: days,
            total_price: totalPrice
        })
    })
    .then(async response => {
        if (!response.ok) throw new Error((await response.json()).message || 'Erreur serveur');
        return response.json();
    })
    .then(data => {
        if (!data.success) throw new Error(data.message);
        inputElement.classList.add('border-green-500');
        setTimeout(() => inputElement.classList.remove('border-green-500'), 2000);

        // Masquer le bouton une fois enregistré
        const saveButton = inputElement.parentElement.querySelector('.save-price-btn');
        saveButton.classList.add('hidden');
    })
    .catch(error => {
        alert(`Erreur: ${error.message}`);
        if (finalPriceElement) finalPriceElement.textContent = '-- DT';
        inputElement.value = '';
    });
}


</script>



@endsection